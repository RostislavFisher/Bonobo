<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/account.css">
    <title></title>
</head>
<body>
<div id="holder">
    <div id="body">

        <div class="accountModule center">
            <form id="RegistrationForm">

            <div class="center">
                <h1 style="text-align: center">Registration music</h1>
            </div>
            <div class="center">
                <label for="email">Name:</label><br>
                <input type="text" id="name" name="text" required><br>
            </div>
            <div class="center">
                <label for="email">Email:</label><br>
                <input type="text" id="email" name="email" pattern="[a-z0-9._%+\-]+@[a-z0-9.\-]+\.[a-z]{2,}$"><br>
            </div>
            <div class="center">
                <label for="password">Password:</label><br>
                <input type="password" id="password" name="password" pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9]).{6,}"><br><br>
            </div>
            <div class="center">
                <button class="button button5" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square-fill" viewBox="0 0 16 16">
                        <path d="M0 14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v12zm4.5-6.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5a.5.5 0 0 1 0-1z"/>
                    </svg>
                    Submit
                </button>
            </div>
            <a href="/smarthouse/Login.html">I already have an account</a>
            </form>

        </div>

    </div>

</div>


</body>
<script>
    function Registration(){
        let name = document.getElementById("name").value;
        let email = document.getElementById("email").value;
        let password = document.getElementById("password").value;
        let req = new XMLHttpRequest();
        let formData = new FormData();
        formData.append("name", name);
        formData.append("email", email);
        formData.append("password", password);
        req.open("POST", '/userRegistration');
        req.send(formData);
        req.onreadystatechange = function() {

            if (this.readyState == 4 && this.status == 200) {
                let response = JSON.parse(req.responseText);
                if(response["result"] === "OK"){
                    window.location.href = "/smarthouse/index.html";
                }
                else{
                    alert("Registration failed");
                }
            }
        };

    }
    let RegistrationForm = document.getElementById("RegistrationForm");
    RegistrationForm.addEventListener("submit", (e) => {
        e.preventDefault();
        Registration();

    })

</script>

</html>
